<div class="mb-4 flex flex-row items-center gap-2">
  <a routerLink="/templates" mat-icon-button class="lg:hidden! block">
    <fa-duotone-icon [icon]="faArrowLeft" />
  </a>
  <h1 class="title-large">Template Categories</h1>
</div>

<button
  mat-fab
  extended
  (click)="openCategoryCreationDialog()"
  class="fab-fixed"
>
  <mat-icon svgIcon="faPlus" />
  Create category
</button>

<main>
  @if (templateCategoryGroupsQuery.isPending()) {
    <div
      class="bg-surface text-on-surface flex animate-pulse cursor-progress flex-col gap-2 rounded-2xl p-4"
    >
      <h2 class="title-medium">Loading ...</h2>
    </div>
  } @else if (templateCategoryGroupsQuery.isError()) {
    <p>Error: {{ templateCategoryGroupsErrorMessage() }}</p>
  } @else if (templateCategoryGroupsQuery.isSuccess()) {
    @if (templateCategoryGroupsQuery.data().length === 0) {
      <p>No categories found</p>
      <button mat-flat-button (click)="openCategoryCreationDialog()">
        Create a new category
      </button>
    } @else {
      <div class="overflow-x-auto overflow-y-hidden rounded-2xl">
        <table
          mat-table
          [dataSource]="templateCategoryGroupsQuery.data()"
          class="w-full bg-surface text-on-surface"
        >
          <ng-container matColumnDef="category">
            <th mat-header-cell *matHeaderCellDef class="label-large">
              Category
            </th>
            <td mat-cell *matCellDef="let element">
              <div class="flex items-center gap-3">
                <app-icon [iconCommonName]="element.icon" size="28" />
                <span class="title-medium">{{ element.title }}</span>
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="templates">
            <th mat-header-cell *matHeaderCellDef class="label-large w-32">
              Templates
            </th>
            <td mat-cell *matCellDef="let element">
              <span class="body-medium">{{ element.templates.length }}</span>
            </td>
          </ng-container>

          <ng-container matColumnDef="actions">
            <th
              mat-header-cell
              *matHeaderCellDef
              class="label-large w-24 text-right"
            >
              Actions
            </th>
            <td mat-cell *matCellDef="let element" class="text-right">
              <button mat-button (click)="openCategoryEditDialog(element)">
                Edit
              </button>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="columnsToDisplay()"></tr>
          <tr mat-row *matRowDef="let row; columns: columnsToDisplay()"></tr>
        </table>
      </div>
    }
  }
</main>
