<h1 mat-dialog-title>Add receipt</h1>
<form (submit)="onSubmit($event)">
  <mat-dialog-content class="flex flex-col gap-4">
    <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
      <mat-form-field>
        <mat-label>Receipt date</mat-label>
        <input matInput type="date" [formControl]="form.controls.receiptDate" />
      </mat-form-field>

      <mat-form-field>
        <mat-label>Purchase country</mat-label>
        <input
          matInput
          maxlength="2"
          placeholder="DE"
          [formControl]="form.controls.purchaseCountry"
        />
      </mat-form-field>

      <mat-form-field>
        <mat-label>Tax rate</mat-label>
        <mat-select [formControl]="form.controls.stripeTaxRateId">
          @for (taxRate of data.taxRates; track taxRate.stripeTaxRateId) {
            <mat-option [value]="taxRate.stripeTaxRateId">
              {{ formatTaxRateLabel(taxRate) }}
            </mat-option>
          }
        </mat-select>
      </mat-form-field>

      <mat-form-field>
        <mat-label>Total amount (EUR)</mat-label>
        <input
          matInput
          min="0"
          step="0.01"
          type="number"
          [formControl]="form.controls.totalAmount"
        />
      </mat-form-field>

      <mat-form-field>
        <mat-label>Deposit amount (EUR)</mat-label>
        <input
          matInput
          min="0"
          step="0.01"
          type="number"
          [formControl]="form.controls.depositAmount"
        />
      </mat-form-field>

      <mat-form-field>
        <mat-label>Alcohol amount (EUR)</mat-label>
        <input
          matInput
          min="0"
          step="0.01"
          type="number"
          [formControl]="form.controls.alcoholAmount"
        />
      </mat-form-field>
    </div>

    <div class="flex flex-wrap gap-4">
      <label class="inline-flex items-center gap-2">
        <input type="checkbox" [formControl]="form.controls.hasDeposit" />
        <span>Deposit involved</span>
      </label>
      <label class="inline-flex items-center gap-2">
        <input type="checkbox" [formControl]="form.controls.hasAlcohol" />
        <span>Alcohol purchased</span>
      </label>
    </div>

    <div class="flex flex-col gap-2">
      <label class="font-medium" for="receipt-file-input"
        >Receipt file (image or PDF)</label
      >
      <input
        id="receipt-file-input"
        type="file"
        accept="image/*,application/pdf"
        (change)="onFileSelected($event)"
      />
      @if (file()) {
        <p class="text-sm">{{ file()!.name }} ({{ file()!.type }})</p>
      }
    </div>

    @if (errorMessage()) {
      <p class="text-error text-sm">{{ errorMessage() }}</p>
    }
  </mat-dialog-content>
  <mat-dialog-actions align="end" class="gap-2">
    <button mat-button mat-dialog-close type="button">Cancel</button>
    <button mat-raised-button color="primary" type="submit">Submit receipt</button>
  </mat-dialog-actions>
</form>
